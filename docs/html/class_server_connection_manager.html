<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MarvinCpp: ServerConnectionManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MarvinCpp
   </div>
   <div id="projectbrief">Man in the middle proxy</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="class_server_connection_manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ServerConnectionManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="server__connection__manager_8hpp_source.html">server_connection_manager.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a28eaf417682341e6f8c733b30c59bbd8"><td class="memItemLeft" align="right" valign="top">typedef std::function&lt; void()&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a28eaf417682341e6f8c733b30c59bbd8">AllowAnotherCallback</a></td></tr>
<tr class="separator:a28eaf417682341e6f8c733b30c59bbd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8f20818d0fd29612ce09f694aaad0271"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a8f20818d0fd29612ce09f694aaad0271">ServerConnectionManager</a> (const <a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> &amp;)=delete</td></tr>
<tr class="separator:a8f20818d0fd29612ce09f694aaad0271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3193017398278086cb7d79820987c5e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a3193017398278086cb7d79820987c5e2">operator=</a> (const <a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> &amp;)=delete</td></tr>
<tr class="separator:a3193017398278086cb7d79820987c5e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b2c91c8c5f07706cbec0bb08de8039d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a0b2c91c8c5f07706cbec0bb08de8039d">ServerConnectionManager</a> (boost::asio::io_service &amp;io, boost::asio::strand &amp;serverStrand, int max_connections)</td></tr>
<tr class="memdesc:a0b2c91c8c5f07706cbec0bb08de8039d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a connection manager. The connection handler must operate in a single threaded manner. That is achieved by requiring it to always execute on the server strand.  <a href="#a0b2c91c8c5f07706cbec0bb08de8039d">More...</a><br /></td></tr>
<tr class="separator:a0b2c91c8c5f07706cbec0bb08de8039d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9661756cbecdbec901860ffec5cf6e47"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a9661756cbecdbec901860ffec5cf6e47">allowAnotherConnection</a> (<a class="el" href="class_server_connection_manager.html#a28eaf417682341e6f8c733b30c59bbd8">AllowAnotherCallback</a> cb)</td></tr>
<tr class="memdesc:a9661756cbecdbec901860ffec5cf6e47"><td class="mdescLeft">&#160;</td><td class="mdescRight">called by server to verify that another accept is permitted within the context of the ConnectionManager's rescource allocation scheme.  <a href="#a9661756cbecdbec901860ffec5cf6e47">More...</a><br /></td></tr>
<tr class="separator:a9661756cbecdbec901860ffec5cf6e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c03c50b5154af1424ed92a35cd6389"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#aa2c03c50b5154af1424ed92a35cd6389">registerConnectionHandler</a> (<a class="el" href="class_connection_handler.html">ConnectionHandler</a> *connHandler)</td></tr>
<tr class="memdesc:aa2c03c50b5154af1424ed92a35cd6389"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a connection handler in a table so that it stays around to process request/response and increments the count of connection handler active.  <a href="#aa2c03c50b5154af1424ed92a35cd6389">More...</a><br /></td></tr>
<tr class="separator:aa2c03c50b5154af1424ed92a35cd6389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61073d71f21045b5202fa035e9da282f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a61073d71f21045b5202fa035e9da282f">deregister</a> (<a class="el" href="class_connection_handler.html">ConnectionHandler</a> *ch)</td></tr>
<tr class="memdesc:a61073d71f21045b5202fa035e9da282f"><td class="mdescLeft">&#160;</td><td class="mdescRight">deregister the specified connection, removes from the table and decrements the count of active connection handlers.  <a href="#a61073d71f21045b5202fa035e9da282f">More...</a><br /></td></tr>
<tr class="separator:a61073d71f21045b5202fa035e9da282f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a3b22ce780b4762ad06e7f2ffbb611"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a83a3b22ce780b4762ad06e7f2ffbb611">stop_all</a> ()</td></tr>
<tr class="separator:a83a3b22ce780b4762ad06e7f2ffbb611"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a548c5d053584a2a0bf18a1422a802b95"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a548c5d053584a2a0bf18a1422a802b95">get_instance</a> ()</td></tr>
<tr class="separator:a548c5d053584a2a0bf18a1422a802b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aabc84134814ff480b8214bda06cb26"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a2aabc84134814ff480b8214bda06cb26">verify</a> ()</td></tr>
<tr class="separator:a2aabc84134814ff480b8214bda06cb26"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a79204557e4949379c3197dd476d74ccb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server_connection_manager.html#a79204557e4949379c3197dd476d74ccb">instance</a></td></tr>
<tr class="separator:a79204557e4949379c3197dd476d74ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a28eaf417682341e6f8c733b30c59bbd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28eaf417682341e6f8c733b30c59bbd8">&#9670;&nbsp;</a></span>AllowAnotherCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::function&lt;void()&gt; <a class="el" href="class_server_connection_manager.html#a28eaf417682341e6f8c733b30c59bbd8">ServerConnectionManager::AllowAnotherCallback</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8f20818d0fd29612ce09f694aaad0271"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f20818d0fd29612ce09f694aaad0271">&#9670;&nbsp;</a></span>ServerConnectionManager() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ServerConnectionManager::ServerConnectionManager </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0b2c91c8c5f07706cbec0bb08de8039d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2c91c8c5f07706cbec0bb08de8039d">&#9670;&nbsp;</a></span>ServerConnectionManager() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ServerConnectionManager::ServerConnectionManager </td>
          <td>(</td>
          <td class="paramtype">boost::asio::io_service &amp;&#160;</td>
          <td class="paramname"><em>io</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::asio::strand &amp;&#160;</td>
          <td class="paramname"><em>serverStrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_connections</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a connection manager. The connection handler must operate in a single threaded manner. That is achieved by requiring it to always execute on the server strand. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9661756cbecdbec901860ffec5cf6e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9661756cbecdbec901860ffec5cf6e47">&#9670;&nbsp;</a></span>allowAnotherConnection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnectionManager::allowAnotherConnection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_server_connection_manager.html#a28eaf417682341e6f8c733b30c59bbd8">ServerConnectionManager::AllowAnotherCallback</a>&#160;</td>
          <td class="paramname"><em>cb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>called by server to verify that another accept is permitted within the context of the ConnectionManager's rescource allocation scheme. </p>
<p>If not the ConnectionManager will wait till there is enough resource and invoke the cb to signal the server to continue. Did it this was so that the ConnectionManager does not need to know how to create <a class="el" href="class_connection_handler.html" title="An instance of this class is created by the server foor every open client connection; this instance m...">ConnectionHandler</a>, <a class="el" href="class_request_handler.html" title="The common handler for all incoming requests. ">RequestHandler</a> </p>

</div>
</div>
<a id="a61073d71f21045b5202fa035e9da282f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61073d71f21045b5202fa035e9da282f">&#9670;&nbsp;</a></span>deregister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnectionManager::deregister </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_connection_handler.html">ConnectionHandler</a> *&#160;</td>
          <td class="paramname"><em>ch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>deregister the specified connection, removes from the table and decrements the count of active connection handlers. </p>
<p>If the there is a "allow another callback" set invoke this callback if the number of active connection handlers is below the max allowed</p>
<p>This is called from a <a class="el" href="class_connection_handler.html" title="An instance of this class is created by the server foor every open client connection; this instance m...">ConnectionHandler</a> running on an arbitary io_service. need to post the real action on the server strand. </p>

</div>
</div>
<a id="a548c5d053584a2a0bf18a1422a802b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a548c5d053584a2a0bf18a1422a802b95">&#9670;&nbsp;</a></span>get_instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> * ServerConnectionManager::get_instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3193017398278086cb7d79820987c5e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3193017398278086cb7d79820987c5e2">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a>&amp; ServerConnectionManager::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa2c03c50b5154af1424ed92a35cd6389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c03c50b5154af1424ed92a35cd6389">&#9670;&nbsp;</a></span>registerConnectionHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnectionManager::registerConnectionHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_connection_handler.html">ConnectionHandler</a> *&#160;</td>
          <td class="paramname"><em>connHandler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a connection handler in a table so that it stays around to process request/response and increments the count of connection handler active. </p>
<p>This method is ALWAYS called from the server strand so do not have to post it on that strand. </p>

</div>
</div>
<a id="a83a3b22ce780b4762ad06e7f2ffbb611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a3b22ce780b4762ad06e7f2ffbb611">&#9670;&nbsp;</a></span>stop_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ServerConnectionManager::stop_all </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stop all connections. </p>

</div>
</div>
<a id="a2aabc84134814ff480b8214bda06cb26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aabc84134814ff480b8214bda06cb26">&#9670;&nbsp;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ServerConnectionManager::verify </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a79204557e4949379c3197dd476d74ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79204557e4949379c3197dd476d74ccb">&#9670;&nbsp;</a></span>instance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_server_connection_manager.html">ServerConnectionManager</a> * ServerConnectionManager::instance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd><ul>
<li>the code in this file needs tidying up - too many commented out lines </li>
</ul>
</dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>marvin/server/<a class="el" href="server__connection__manager_8hpp_source.html">server_connection_manager.hpp</a></li>
<li>marvin/server/<a class="el" href="server__connection__manager_8cpp.html">server_connection_manager.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
